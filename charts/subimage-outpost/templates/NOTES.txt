Thank you for installing {{ .Chart.Name }}!

Your SubImage Outpost has been deployed to namespace: {{ .Values.namespace.name }}

ğŸ“Š Deployment Status:
  Release Name: {{ .Release.Name }}
  Chart Version: {{ .Chart.Version }}
  Image Version: {{ .Values.image.tag }}
  {{- if .Values.outpost.tenantId }}
  Tenant ID: {{ .Values.outpost.tenantId }}
  Tailscale Hostname: {{ printf "%s-%s-outpost" .Values.outpost.tenantId .Values.outpost.name }}
  {{- end }}
  Proxy Target: {{ .Values.outpost.proxyTarget }}

ğŸ” Check deployment status:
  kubectl get pods -n {{ .Values.namespace.name }} -l app.kubernetes.io/name={{ include "subimage-outpost.name" . }}

ğŸ“ View logs:
  kubectl logs -n {{ .Values.namespace.name }} -l app.kubernetes.io/name={{ include "subimage-outpost.name" . }} -f

ğŸ”— Verify Tailscale connection:
  kubectl exec -n {{ .Values.namespace.name }} deployment/{{ include "subimage-outpost.fullname" . }} -- tailscale status

{{- if .Values.outpost.tenantId }}
ğŸŒ Once connected, access via Tailscale:
  http://{{ printf "%s-%s-outpost" .Values.outpost.tenantId .Values.outpost.name }}.tail<network-id>.ts.net/
{{- end }}

{{- if not .Values.outpost.tenantId }}

âš ï¸  ERROR: Tenant ID is required!
  Set with: --set outpost.tenantId="your-tenant-id"
{{- end }}

{{- if not .Values.outpost.authKey }}

âš ï¸  WARNING: No Tailscale OAuth client secret provided!
  Update the secret with your OAuth client secret (provided by SubImage):

  kubectl create secret generic {{ include "subimage-outpost.fullname" . }}-secrets \
    -n {{ .Values.namespace.name }} \
    --from-literal=TAILSCALE_AUTHKEY='tskey-client-xxxxx-xxxxxxxxxxxxxx' \
    --dry-run=client -o yaml | kubectl apply -f -

  Then restart the deployment:
  kubectl rollout restart deployment/{{ include "subimage-outpost.fullname" . }} -n {{ .Values.namespace.name }}
{{- end }}

{{- if .Values.proxy.enabled }}

ğŸ”§ Corporate proxy enabled:
  HTTP_PROXY: {{ .Values.proxy.httpProxy }}
  HTTPS_PROXY: {{ .Values.proxy.httpsProxy }}
{{- end }}

{{- if .Values.networkPolicy.enabled }}

ğŸ”’ NetworkPolicy is enabled for Tailscale connectivity
{{- end }}

{{- if .Values.rbac.create }}

ğŸ” RBAC Configuration:
  âœ… ClusterRole created with minimum required permissions

  ServiceAccount: {{ .Values.serviceAccount.name | default (include "subimage-outpost.fullname" .) }}
  ClusterRole: {{ include "subimage-outpost.fullname" . }}
  ClusterRoleBinding: {{ include "subimage-outpost.fullname" . }}

  ğŸ§ª Test API access from pod:
    kubectl exec -n {{ .Values.namespace.name }} deployment/{{ include "subimage-outpost.fullname" . }} -- \
      curl -sk -H "Authorization: Bearer $(cat /var/run/secrets/kubernetes.io/serviceaccount/token)" \
      https://kubernetes.default.svc/api/v1/namespaces
{{- else }}

âš ï¸  RBAC is disabled!
  If accessing the Kubernetes API, requests will fail with 401/403 errors.
  Enable with: --set rbac.create=true
{{- end }}

ğŸ’¡ Troubleshooting:
  - If pod is pending: kubectl describe pod -n {{ .Values.namespace.name }} -l app.kubernetes.io/name={{ include "subimage-outpost.name" . }}
  - If ImagePullBackOff: Verify ECR access and image pull secrets
  - If Tailscale fails: Check NetworkPolicy allows egress to TCP 443, UDP 3478, UDP 41641

ğŸ“š Documentation: See README.md for complete configuration options

For support: https://github.com/subimagesec/helm-charts/issues
